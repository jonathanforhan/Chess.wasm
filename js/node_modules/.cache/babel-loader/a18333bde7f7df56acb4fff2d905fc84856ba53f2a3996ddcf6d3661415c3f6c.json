{"ast":null,"code":"import _slicedToArray from\"/home/jon/dev/chess-wasm/js/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./App.css';import{useState,useRef}from'react';import{Chessboard}from'react-chessboard';import SideMenu from'./components/SideMenu';import useWindowDimensions from'./util/useWindowDimensions';import init,{Chess}from\"./engine/chess_wasm.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _window=useWindowDimensions();var _useState=useState(new Chess()),_useState2=_slicedToArray(_useState,2),game=_useState2[0],setGame=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),currentTimeout=_useState4[0],setCurrentTimeout=_useState4[1];var chessboardRef=useRef(null);/**\n   * @param {function} modify - modify function for the game Object\n   * @returns {Object} update - updated game Object\n   */function safeGameMutate(modify){setGame(function(g){var update=new Chess(g.get_fen());modify(update);return update;});}/**\n   * @param {string} fen - fen notation of current position\n   */function oppTurn(fen){init().then(function(){var chess=new Chess(fen);console.log(chess.get_fen());safeGameMutate(function(g){return g.move({from:\"a7\",to:\"a5\"});});});}/**\n   * @param {string, string} src, dst - src square and destination dquare\n   * @returns {boolean} - validity of move\n   */function onDrop(src,dst){var gameCopy=new Chess(game.fen());try{gameCopy.move({from:src,to:dst,promotion:\"q\"});}catch(_unused){return false;}setGame(gameCopy);var newTimeout=setTimeout(oppTurn(gameCopy.fen()),300);setCurrentTimeout(newTimeout);return true;}return/*#__PURE__*/_jsxs(\"div\",{className:\"App flex justify-center bg-slate-700 py-20 h-[100vh]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ChessboardWrapper\",children:/*#__PURE__*/_jsx(Chessboard,{id:\"chessBoard\",position:game.fen(),onPieceDrop:onDrop,arePremovesAllowed:true,boardWidth:_window.height-160,customBoardStyle:{borderRadius:\"4px\",boxShadow:\"0 2px 10px rgba(0, 0, 0, 0.5)\"},customDarkSquareStyle:{backgroundColor:\"#779952\"},customLightSquareStyle:{backgroundColor:\"#edeed1\"}})}),/*#__PURE__*/_jsx(SideMenu,{safeGameMutate:safeGameMutate,chessboardRef:chessboardRef,currentTimeout:currentTimeout})]});}export default App;","map":{"version":3,"names":["useState","useRef","Chessboard","SideMenu","useWindowDimensions","init","Chess","App","_window","game","setGame","currentTimeout","setCurrentTimeout","chessboardRef","safeGameMutate","modify","g","update","get_fen","oppTurn","fen","then","chess","console","log","move","from","to","onDrop","src","dst","gameCopy","promotion","newTimeout","setTimeout","height","borderRadius","boxShadow","backgroundColor"],"sources":["/home/jon/dev/chess-wasm/js/src/App.js"],"sourcesContent":["import './App.css';\nimport { useState, useRef } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport SideMenu from './components/SideMenu';\nimport useWindowDimensions from './util/useWindowDimensions';\nimport init, { Chess } from \"./engine/chess_wasm.js\"\n\nfunction App() {\n  const _window = useWindowDimensions();\n\n  const [game, setGame] = useState(new Chess());\n  const [currentTimeout, setCurrentTimeout] = useState();\n  const chessboardRef = useRef(null);\n\n  /**\n   * @param {function} modify - modify function for the game Object\n   * @returns {Object} update - updated game Object\n   */\n  function safeGameMutate(modify) {\n    setGame((g) => {\n      const update = new Chess(g.get_fen());\n      modify(update);\n      return update;\n    });\n  }\n\n  /**\n   * @param {string} fen - fen notation of current position\n   */\n  function oppTurn(fen) {\n    init().then(() => {\n      let chess = new Chess(fen);\n      console.log(chess.get_fen());\n      safeGameMutate(g => g.move({ from: \"a7\", to: \"a5\" }));\n    });\n  }\n\n  /**\n   * @param {string, string} src, dst - src square and destination dquare\n   * @returns {boolean} - validity of move\n   */\n  function onDrop(src, dst) {\n    let gameCopy = new Chess(game.fen());\n    try {\n      gameCopy.move({\n        from: src,\n        to: dst,\n        promotion: \"q\",\n      });\n    } catch {\n      return false;\n    }\n    setGame(gameCopy);\n    const newTimeout = setTimeout(oppTurn(gameCopy.fen()), 300);\n    setCurrentTimeout(newTimeout);\n\n    return true;\n  }\n\n  return (\n    <div className='App flex justify-center bg-slate-700 py-20 h-[100vh]'>\n      <div className='ChessboardWrapper'>\n        <Chessboard\n          id='chessBoard'\n          position={game.fen()}\n          onPieceDrop={onDrop}\n          arePremovesAllowed={true}\n          boardWidth={_window.height - 160}\n          customBoardStyle={{\n            borderRadius: \"4px\",\n            boxShadow: \"0 2px 10px rgba(0, 0, 0, 0.5)\",\n          }}\n          customDarkSquareStyle={{ backgroundColor: \"#779952\" }}\n          customLightSquareStyle={{ backgroundColor: \"#edeed1\" }}\n          \n        />\n      </div>\n      <SideMenu\n        safeGameMutate={safeGameMutate}\n        chessboardRef={chessboardRef}\n        currentTimeout={currentTimeout}\n      />\n      </div>\n  );\n}\n\nexport default App;\n"],"mappings":"iHAAA,MAAO,WAAW,CAClB,OAASA,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CACxC,OAASC,UAAU,KAAQ,kBAAkB,CAC7C,MAAOC,SAAQ,KAAM,uBAAuB,CAC5C,MAAOC,oBAAmB,KAAM,4BAA4B,CAC5D,MAAOC,KAAI,EAAIC,KAAK,KAAQ,wBAAwB,yFAEpD,QAASC,IAAG,EAAG,CACb,GAAMC,QAAO,CAAGJ,mBAAmB,EAAE,CAErC,cAAwBJ,QAAQ,CAAC,GAAIM,MAAK,EAAE,CAAC,wCAAtCG,IAAI,eAAEC,OAAO,eACpB,eAA4CV,QAAQ,EAAE,yCAA/CW,cAAc,eAAEC,iBAAiB,eACxC,GAAMC,cAAa,CAAGZ,MAAM,CAAC,IAAI,CAAC,CAElC;AACF;AACA;AACA,KACE,QAASa,eAAc,CAACC,MAAM,CAAE,CAC9BL,OAAO,CAAC,SAACM,CAAC,CAAK,CACb,GAAMC,OAAM,CAAG,GAAIX,MAAK,CAACU,CAAC,CAACE,OAAO,EAAE,CAAC,CACrCH,MAAM,CAACE,MAAM,CAAC,CACd,MAAOA,OAAM,CACf,CAAC,CAAC,CACJ,CAEA;AACF;AACA,KACE,QAASE,QAAO,CAACC,GAAG,CAAE,CACpBf,IAAI,EAAE,CAACgB,IAAI,CAAC,UAAM,CAChB,GAAIC,MAAK,CAAG,GAAIhB,MAAK,CAACc,GAAG,CAAC,CAC1BG,OAAO,CAACC,GAAG,CAACF,KAAK,CAACJ,OAAO,EAAE,CAAC,CAC5BJ,cAAc,CAAC,SAAAE,CAAC,QAAIA,EAAC,CAACS,IAAI,CAAC,CAAEC,IAAI,CAAE,IAAI,CAAEC,EAAE,CAAE,IAAK,CAAC,CAAC,GAAC,CACvD,CAAC,CAAC,CACJ,CAEA;AACF;AACA;AACA,KACE,QAASC,OAAM,CAACC,GAAG,CAAEC,GAAG,CAAE,CACxB,GAAIC,SAAQ,CAAG,GAAIzB,MAAK,CAACG,IAAI,CAACW,GAAG,EAAE,CAAC,CACpC,GAAI,CACFW,QAAQ,CAACN,IAAI,CAAC,CACZC,IAAI,CAAEG,GAAG,CACTF,EAAE,CAAEG,GAAG,CACPE,SAAS,CAAE,GACb,CAAC,CAAC,CACJ,CAAE,cAAM,CACN,MAAO,MAAK,CACd,CACAtB,OAAO,CAACqB,QAAQ,CAAC,CACjB,GAAME,WAAU,CAAGC,UAAU,CAACf,OAAO,CAACY,QAAQ,CAACX,GAAG,EAAE,CAAC,CAAE,GAAG,CAAC,CAC3DR,iBAAiB,CAACqB,UAAU,CAAC,CAE7B,MAAO,KAAI,CACb,CAEA,mBACE,aAAK,SAAS,CAAC,sDAAsD,wBACnE,YAAK,SAAS,CAAC,mBAAmB,uBAChC,KAAC,UAAU,EACT,EAAE,CAAC,YAAY,CACf,QAAQ,CAAExB,IAAI,CAACW,GAAG,EAAG,CACrB,WAAW,CAAEQ,MAAO,CACpB,kBAAkB,CAAE,IAAK,CACzB,UAAU,CAAEpB,OAAO,CAAC2B,MAAM,CAAG,GAAI,CACjC,gBAAgB,CAAE,CAChBC,YAAY,CAAE,KAAK,CACnBC,SAAS,CAAE,+BACb,CAAE,CACF,qBAAqB,CAAE,CAAEC,eAAe,CAAE,SAAU,CAAE,CACtD,sBAAsB,CAAE,CAAEA,eAAe,CAAE,SAAU,CAAE,EAEvD,EACE,cACN,KAAC,QAAQ,EACP,cAAc,CAAExB,cAAe,CAC/B,aAAa,CAAED,aAAc,CAC7B,cAAc,CAAEF,cAAe,EAC/B,GACI,CAEZ,CAEA,cAAeJ,IAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}