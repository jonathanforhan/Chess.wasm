{"ast":null,"code":"import _regeneratorRuntime from\"/home/jon/dev/shallow_blue/test/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/jon/dev/shallow_blue/test/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/jon/dev/shallow_blue/test/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./App.css';import{useState,useRef}from'react';import{Chessboard}from'react-chessboard';import{Chess}from'chess.js';import SideMenu from'./components/SideMenu';import useWindowDimensions from'./util/useWindowDimensions';import fetchMove from'./util/fetchMove';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _window=useWindowDimensions();var _useState=useState(new Chess()),_useState2=_slicedToArray(_useState,2),game=_useState2[0],setGame=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),currentTimeout=_useState4[0],setCurrentTimeout=_useState4[1];var chessboardRef=useRef(null);var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),position=_useState6[0],setPosition=_useState6[1];function safeGameMutate(modify){setGame(function(g){var update=Object.assign(Object.create(Object.getPrototypeOf(g)),g);modify(update);return update;});}function oppTurn(){return _oppTurn.apply(this,arguments);}function _oppTurn(){_oppTurn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:console.log(game.fen());_context.next=3;return fetchMove(game.fen()).then(function(move){safeGameMutate(function(g){return g.move(move);});});case 3:case\"end\":return _context.stop();}},_callee);}));return _oppTurn.apply(this,arguments);}function onDrop(src,dst){// gameCopy is deep copy that maintains prototype\nvar gameCopy=Object.assign(Object.create(Object.getPrototypeOf(game)),game);try{gameCopy.move({from:src,to:dst,promotion:\"q\"});}catch(_unused){return false;}setGame(gameCopy);var newTimeout=setTimeout(oppTurn,400);setCurrentTimeout(newTimeout);return true;}return/*#__PURE__*/_jsxs(\"div\",{className:\"App flex justify-center bg-slate-700 py-20 h-[100vh]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ChessboardWrapper\",children:/*#__PURE__*/_jsx(Chessboard,{id:\"chessBoard\",position:game.fen(),getPositionObject:setPosition,onPieceDrop:onDrop,arePremovesAllowed:true,boardWidth:_window.height-160,customBoardStyle:{borderRadius:\"4px\",boxShadow:\"0 2px 10px rgba(0, 0, 0, 0.5)\"},customDarkSquareStyle:{backgroundColor:\"#779952\"},customLightSquareStyle:{backgroundColor:\"#edeed1\"}})}),/*#__PURE__*/_jsx(SideMenu,{safeGameMutate:safeGameMutate,chessboardRef:chessboardRef,currentTimeout:currentTimeout})]});}export default App;","map":{"version":3,"names":["useState","useRef","Chessboard","Chess","SideMenu","useWindowDimensions","fetchMove","App","_window","game","setGame","currentTimeout","setCurrentTimeout","chessboardRef","position","setPosition","safeGameMutate","modify","g","update","Object","assign","create","getPrototypeOf","oppTurn","console","log","fen","then","move","onDrop","src","dst","gameCopy","from","to","promotion","newTimeout","setTimeout","height","borderRadius","boxShadow","backgroundColor"],"sources":["/home/jon/dev/shallow_blue/test/client/src/App.js"],"sourcesContent":["import './App.css';\nimport { useState, useRef } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport { Chess } from 'chess.js'\nimport SideMenu from './components/SideMenu';\nimport useWindowDimensions from './util/useWindowDimensions';\nimport fetchMove from './util/fetchMove';\n\nfunction App() {\n  const _window = useWindowDimensions();\n\n  const [game, setGame] = useState(new Chess());\n  const [currentTimeout, setCurrentTimeout] = useState();\n  const chessboardRef = useRef(null);\n\n  const [position, setPosition] = useState();\n\n  function safeGameMutate(modify) {\n    setGame((g) => {\n      const update = Object.assign(Object.create(Object.getPrototypeOf(g)), g);\n      modify(update);\n      return update;\n    });\n  }\n\n  async function oppTurn() {\n    console.log(game.fen())\n    await fetchMove(game.fen()).then((move) => {\n      safeGameMutate(g => g.move(move))\n    });\n  }\n\n  function onDrop(src, dst) {\n    // gameCopy is deep copy that maintains prototype\n    let gameCopy = Object.assign(Object.create(Object.getPrototypeOf(game)), game);\n    try {\n      gameCopy.move({\n        from: src,\n        to: dst,\n        promotion: \"q\",\n      });\n    } catch {\n      return false;\n    }\n    setGame(gameCopy)\n    const newTimeout = setTimeout(oppTurn, 400);\n    setCurrentTimeout(newTimeout);\n\n    return true;\n  }\n\n  return (\n    <div className='App flex justify-center bg-slate-700 py-20 h-[100vh]'>\n      <div className='ChessboardWrapper'>\n        <Chessboard\n          id='chessBoard'\n          position={game.fen()}\n          getPositionObject={setPosition}\n          onPieceDrop={onDrop}\n          arePremovesAllowed={true}\n          boardWidth={_window.height - 160}\n          customBoardStyle={{\n            borderRadius: \"4px\",\n            boxShadow: \"0 2px 10px rgba(0, 0, 0, 0.5)\",\n          }}\n          customDarkSquareStyle={{ backgroundColor: \"#779952\" }}\n          customLightSquareStyle={{ backgroundColor: \"#edeed1\" }}\n          \n        />\n      </div>\n      <SideMenu\n        safeGameMutate={safeGameMutate}\n        chessboardRef={chessboardRef}\n        currentTimeout={currentTimeout}\n      />\n      </div>\n  );\n}\n\nexport default App;\n"],"mappings":"oYAAA,MAAO,WAAW,CAClB,OAASA,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CACxC,OAASC,UAAU,KAAQ,kBAAkB,CAC7C,OAASC,KAAK,KAAQ,UAAU,CAChC,MAAOC,SAAQ,KAAM,uBAAuB,CAC5C,MAAOC,oBAAmB,KAAM,4BAA4B,CAC5D,MAAOC,UAAS,KAAM,kBAAkB,CAAC,wFAEzC,QAASC,IAAG,EAAG,CACb,GAAMC,QAAO,CAAGH,mBAAmB,EAAE,CAErC,cAAwBL,QAAQ,CAAC,GAAIG,MAAK,EAAE,CAAC,wCAAtCM,IAAI,eAAEC,OAAO,eACpB,eAA4CV,QAAQ,EAAE,yCAA/CW,cAAc,eAAEC,iBAAiB,eACxC,GAAMC,cAAa,CAAGZ,MAAM,CAAC,IAAI,CAAC,CAElC,eAAgCD,QAAQ,EAAE,yCAAnCc,QAAQ,eAAEC,WAAW,eAE5B,QAASC,eAAc,CAACC,MAAM,CAAE,CAC9BP,OAAO,CAAC,SAACQ,CAAC,CAAK,CACb,GAAMC,OAAM,CAAGC,MAAM,CAACC,MAAM,CAACD,MAAM,CAACE,MAAM,CAACF,MAAM,CAACG,cAAc,CAACL,CAAC,CAAC,CAAC,CAAEA,CAAC,CAAC,CACxED,MAAM,CAACE,MAAM,CAAC,CACd,MAAOA,OAAM,CACf,CAAC,CAAC,CACJ,CAAC,QAEcK,QAAO,iIAAtB,oIACEC,OAAO,CAACC,GAAG,CAACjB,IAAI,CAACkB,GAAG,EAAE,CAAC,uBACjBrB,UAAS,CAACG,IAAI,CAACkB,GAAG,EAAE,CAAC,CAACC,IAAI,CAAC,SAACC,IAAI,CAAK,CACzCb,cAAc,CAAC,SAAAE,CAAC,QAAIA,EAAC,CAACW,IAAI,CAACA,IAAI,CAAC,GAAC,CACnC,CAAC,CAAC,sDACH,0CAED,QAASC,OAAM,CAACC,GAAG,CAAEC,GAAG,CAAE,CACxB;AACA,GAAIC,SAAQ,CAAGb,MAAM,CAACC,MAAM,CAACD,MAAM,CAACE,MAAM,CAACF,MAAM,CAACG,cAAc,CAACd,IAAI,CAAC,CAAC,CAAEA,IAAI,CAAC,CAC9E,GAAI,CACFwB,QAAQ,CAACJ,IAAI,CAAC,CACZK,IAAI,CAAEH,GAAG,CACTI,EAAE,CAAEH,GAAG,CACPI,SAAS,CAAE,GACb,CAAC,CAAC,CACJ,CAAE,cAAM,CACN,MAAO,MAAK,CACd,CACA1B,OAAO,CAACuB,QAAQ,CAAC,CACjB,GAAMI,WAAU,CAAGC,UAAU,CAACd,OAAO,CAAE,GAAG,CAAC,CAC3CZ,iBAAiB,CAACyB,UAAU,CAAC,CAE7B,MAAO,KAAI,CACb,CAEA,mBACE,aAAK,SAAS,CAAC,sDAAsD,wBACnE,YAAK,SAAS,CAAC,mBAAmB,uBAChC,KAAC,UAAU,EACT,EAAE,CAAC,YAAY,CACf,QAAQ,CAAE5B,IAAI,CAACkB,GAAG,EAAG,CACrB,iBAAiB,CAAEZ,WAAY,CAC/B,WAAW,CAAEe,MAAO,CACpB,kBAAkB,CAAE,IAAK,CACzB,UAAU,CAAEtB,OAAO,CAAC+B,MAAM,CAAG,GAAI,CACjC,gBAAgB,CAAE,CAChBC,YAAY,CAAE,KAAK,CACnBC,SAAS,CAAE,+BACb,CAAE,CACF,qBAAqB,CAAE,CAAEC,eAAe,CAAE,SAAU,CAAE,CACtD,sBAAsB,CAAE,CAAEA,eAAe,CAAE,SAAU,CAAE,EAEvD,EACE,cACN,KAAC,QAAQ,EACP,cAAc,CAAE1B,cAAe,CAC/B,aAAa,CAAEH,aAAc,CAC7B,cAAc,CAAEF,cAAe,EAC/B,GACI,CAEZ,CAEA,cAAeJ,IAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}